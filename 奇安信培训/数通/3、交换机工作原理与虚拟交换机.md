# 一、冲突域和广播域：
	冲突域：同一介质的多节点共享链路，一条设备发出的广播报文，所有设备均会收到
	广播域：交换机会将广播报文向所有接口转发
# 二、以太网帧格式
	Ethernet II：
		前导码：以太网帧以一个7字节的前导码开始，用于同步接收方的时钟。
		帧定界符：接下来的1字节用于指示数据帧的开始。
		目的mac： 6字节
		源mac：6字节
		type：2字节，指示数据类型或数据长度。例如，它可以指示数据包是ip数据还是arp数据，或者指示数据帧长度
		数据：
		帧校验序列（fcs）：4字节，用于检测数据在传输过程中的错误
总体来说，以太网帧的长度通常在64字节到1518字节之间，不包括前导码和帧起始定界符。当数据不足64字节时，以太网会填充数据以满足最小帧长度的要求，这称为填充。
# 三、园区网：核心-汇聚-接入
园区网可能就全是由交换机组成
![[Pasted image 20231108095050.png]]
四、交换机工作原理：
每台交换机都有一个mac地址表，存放了mac地址与交换机端口编号之间的映射关系
	![[Pasted image 20231108095231.png]]
	mac地址表的维护：
		有目的mac，交换机直接转发（forwading）
		没有目的mac：交换机执行防洪（flooding），向除了接到请求的接口，向其他所有的接口发送数据帧
	交换机mac地址表学习过程：
	交换机收到源mac为mac1，目的mac为mac2的请求包，如果源mac在表中没有，则记录到地址表中；如果目的mac在地址表中没有，则发送防洪数据包（向除源mac端口以外的所有端口发送请求包），目的mac的主机收到泛洪包之后，会发送一个reply包，此时的源mac，交换机的mac表中也没有，记录。
	更新和删除：定时交换机会更新和清除mac表中数据
# 五、虚拟局域网
虚拟局域网vlan可以隔离广播域
### 1、特点：
	不受地域限制
	同一vlan内的设备才能直接进入二层通信
### 2、vlan的实现：
	使用vlan标签：
		在源mac地址后，类型前加上vlan标签，交换机的不同接口也打上vlan标签
		vlanid的编号范围：0-4095 
		注意：0和4095不能使用，能够使用的范围1-4094
				默认vlanid 为 1 
		pvlid：
		![[Pasted image 20231108101045.png]]
	vlan划分方式：
	![[Pasted image 20231108101301.png]]

### 3、vlan链路类型：
		vlan包含两种链路类型：
		接入链路（access link）:将主机接入那个vlan
			用于主机和交换机之间的链路，该链路传输的帧一般没有标记帧，只能加入一个vlan
		干道链路（trunk link）：交换机与交换机之间允许那些vlan通过
			连接交换机与交换机或交换机与路由器之间的链路，该链路传输的帧一般为有标记帧
		混合链路（hybrid）
			hybrid和trunk类似，不过trunk可以通过命令来设置发送时数据帧是否携带tag
		
		![[Pasted image 20231108104441.png]]
### 4、链路聚合
链路聚合（提升带宽，同时还实现了链路备份）：
![[Pasted image 20231108161041.png]]
只有在两端存在不支持lacp协议的设备时才会选择手工设置（手工没有备份功能）
![[Pasted image 20231108161445.png]]
![[Pasted image 20231108163215.png]]
只要通电，物理接口就运行，所以如图中即使上面一条线已经断掉了，由于hub供电，lsw1的数据继续向上面那条线发送数据。正是这种情况，使得手工模式没有数据备份功能。
![[Pasted image 20231108163644.png]]

步骤(两边都要配置)：
```bash
int eth-trunk 1 #1表示接口的编号，仅仅是一个本地的接口编号，随便指定
mode manual
trunkport g  0/0/1 0/0/5
dis eth 3
load-balance ？ #进行hash计算的依据
```
原理：抓包聚合线路时，对加入聚合的线路编号，在进行数据转发时，会使用smac ，dmac，sip，dip进行hash运算（这个hash值的范围是0-7，所以聚合的线最多八条），按照计算的值选择线路编号进行转发

lacp模式：
采用了lacp的一种链路聚合模式。设备之间通过链路聚合控制协议数据单元进行交互。
lacp有快慢两种模式（默认慢模式）：lacp三个周期超时
	块模式：1s一个报文   3秒超时
	慢模式：30s一个报文 90秒超时
![[Pasted image 20231108163858.png]]
